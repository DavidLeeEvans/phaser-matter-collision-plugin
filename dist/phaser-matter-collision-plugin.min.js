!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("phaser")):"function"==typeof define&&define.amd?define(["phaser"],t):"object"==typeof exports?exports.PhaserMatterCollisionPlugin=t(require("phaser")):e.PhaserMatterCollisionPlugin=t(e.Phaser)}(window,function(e){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(t,n){t.exports=e},function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),r={log:console.log,warn:console.warn,error:console.error};function l(e){for(;e.parent!==e;)e=e.parent;return e}function s(e){return function(e){return e.hasOwnProperty("collisionFilter")&&e.hasOwnProperty("parts")&&e.hasOwnProperty("slop")}(e)||e.body||e instanceof o.a.Tilemaps.Tile}function c(e){r.warn("Expected a Matter body, Tile or an object with a body property, but instead, recieved: "+e)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.scene=e,i.events=new o.a.Events.EventEmitter,i.collisionStartListeners=new Map,i.collisionEndListeners=new Map,i.collisionActiveListeners=new Map,i.onCollisionStart=i.onCollisionEvent.bind(i,i.collisionStartListeners,"collisionstart"),i.onCollisionEnd=i.onCollisionEvent.bind(i,i.collisionEndListeners,"collisionend"),i.onCollisionActive=i.onCollisionEvent.bind(i,i.collisionActiveListeners,"collisionactive"),i.scene.events.once("start",i.start,i),i.scene.events.once("destroy",i.destroy,i),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.a.Plugins.ScenePlugin),a(t,[{key:"addOnCollideStart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.objectA,n=e.objectB,i=e.callback,o=e.context;return this.addOnCollide(this.collisionStartListeners,t,n,i,o),this.removeOnCollideStart.bind(this,{objectA:t,objectB:n,callback:i,context:o})}},{key:"addOnCollideEnd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.objectA,n=e.objectB,i=e.callback,o=e.context;return this.addOnCollide(this.collisionEndListeners,t,n,i,o),this.removeOnCollideEnd.bind(this,{objectA:t,objectB:n,callback:i,context:o})}},{key:"addOnCollideActive",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.objectA,n=e.objectB,i=e.callback,o=e.context;return this.addOnCollide(this.collisionActiveListeners,t,n,i,o),this.removeOnCollideActive.bind(this,{objectA:t,objectB:n,callback:i,context:o})}},{key:"removeOnCollideStart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.objectA,n=e.objectB,i=e.callback,o=e.context;this.removeOnCollide(this.collisionStartListeners,t,n,i,o)}},{key:"removeOnCollideEnd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.objectA,n=e.objectB,i=e.callback,o=e.context;this.removeOnCollide(this.collisionEndListeners,t,n,i,o)}},{key:"removeOnCollideActive",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.objectA,n=e.objectB,i=e.callback,o=e.context;this.removeOnCollide(this.collisionActiveListeners,t,n,i,o)}},{key:"removeAllCollideStartListeners",value:function(){this.collisionStartListeners.clear()}},{key:"removeAllCollideActiveListeners",value:function(){this.collisionActiveListeners.clear()}},{key:"removeAllCollideEndListeners",value:function(){this.collisionEndListeners.clear()}},{key:"removeAllCollideListeners",value:function(){this.removeAllCollideStartListeners(),this.removeAllCollideActiveListeners(),this.removeAllCollideEndListeners()}},{key:"removeCollideStartListenersOf",value:function(e){this.removeCollideListenersOf(this.collisionStartListeners,e)}},{key:"removeCollideActiveListenersOf",value:function(e){this.removeCollideListenersOf(this.collisionActiveListeners,e)}},{key:"removeCollideEndListenersOf",value:function(e){this.removeCollideListenersOf(this.collisionEndListeners,e)}},{key:"removeAllCollideListenersOf",value:function(e){this.removeCollideStartListenersOf(e),this.removeCollideActiveListenersOf(e),this.removeCollideEndListenersOf(e)}},{key:"removeCollideListenersOf",value:function(e,t){var n=Array.isArray(t)?t:[t];n.forEach(function(t){return e.delete(t)}),e.forEach(function(t,i){var o=t.filter(function(e){return!n.includes(e.target)});o.length>0?e.set(i,o):e.delete(i)})}},{key:"addOnCollide",value:function(e,t,n,i,o){var r=this;if(i&&"function"==typeof i){var l=Array.isArray(t)?t:[t],s=Array.isArray(n)?n:[n];l.forEach(function(t){s.forEach(function(n){r.addOnCollideObjectVsObject(e,t,n,i,o)})})}else warn("No valid callback specified. Received: "+i)}},{key:"removeOnCollide",value:function(e,t,n,i,o){var r=Array.isArray(r)?t:[t],l=Array.isArray(l)?n:[n];r.forEach(function(t){var n=(e.get(t)||[]).filter(function(e){return!(l.includes(e.target)&&e.callback===i&&e.context===o)});n.length>0?e.set(t,n):e.delete(t)})}},{key:"addOnCollideObjectVsObject",value:function(e,t,n,i,o){if(t&&s(t))if(!n||s(n)){var r=e.get(t)||[];r.push({target:n,callback:i,context:o}),e.set(t,r)}else c(t);else c(t)}},{key:"onCollisionEvent",value:function(e,t,n){var i=this,o=n.pairs,r="pair"+t,s={},c={isReversed:!0};o.map(function(t,n){var a=t.bodyA,u=t.bodyB,d=l(a).gameObject,f=l(u).gameObject;d&&d.tile&&(d=d.tile),f&&f.tile&&(f=f.tile),o[n].gameObjectA=d,o[n].gameObjectB=f,s.bodyA=a,s.bodyB=u,s.gameObjectA=d,s.gameObjectB=f,s.pair=t,i.events.emit(r,s),e.size&&(c.bodyB=a,c.bodyA=u,c.gameObjectB=d,c.gameObjectA=f,c.pair=t,i.checkPairAndEmit(e,a,u,f,s),i.checkPairAndEmit(e,u,a,d,c),d&&i.checkPairAndEmit(e,d,u,f,s),f&&i.checkPairAndEmit(e,f,a,d,c))}),this.events.emit(t,n)}},{key:"checkPairAndEmit",value:function(e,t,n,i,o){var r=e.get(t);r&&r.forEach(function(e){var t=e.target,r=e.callback,l=e.context;t&&t!==n&&t!==i||r.call(l,o)})}},{key:"subscribeMatterEvents",value:function(){var e=this.scene.matter;e&&e.world?(e.world.on("collisionstart",this.onCollisionStart),e.world.on("collisionactive",this.onCollisionActive),e.world.on("collisionend",this.onCollisionEnd)):r.warn("Plugin requires matter!")}},{key:"unsubscribeMatterEvents",value:function(){var e=this.scene.matter;e&&e.world&&(e.world.off("collisionstart",this.onCollisionStart),e.world.off("collisionactive",this.onCollisionActive),e.world.off("collisionend",this.onCollisionEnd))}},{key:"start",value:function(){this.scene.events.off("shutdown",this.shutdown,this),this.scene.events.on("shutdown",this.shutdown,this),this.subscribeMatterEvents()}},{key:"shutdown",value:function(){this.removeAllCollideListeners(),this.unsubscribeMatterEvents(),this.scene.events.once("start",this.start,this)}},{key:"destroy",value:function(){this.scene.events.off("start",this.start,this),this.scene.events.off("shutdown",this.shutdown,this),this.removeAllCollideListeners(),this.unsubscribeMatterEvents(),this.scene=void 0}}]),t}();t.default=u}]).default});
//# sourceMappingURL=phaser-matter-collision-plugin.min.js.map